# Maximize console logging level for kernel printk messages
kernel.printk = 8 4 1 7

# Wait 5 seconds and then reboot
kernel.panic = 5

# Allow neighbor cache entries to expire even when the cache is not full
net.ipv4.neigh.default.gc_thresh1 = 0
net.ipv6.neigh.default.gc_thresh1 = 0

# Avoid neighbor table contention in large subnets
net.ipv4.neigh.default.gc_thresh2 = 15360
net.ipv6.neigh.default.gc_thresh2 = 15360
net.ipv4.neigh.default.gc_thresh3 = 16384
net.ipv6.neigh.default.gc_thresh3 = 16384

# Increasing to account for skb structure growth since the 3.4.x kernel series
net.ipv4.tcp_wmem = 4096 20480 4194304

# Set default TTL to 127.
net.ipv4.ip_default_ttl = 127

# Disable unprivileged access to bpf
kernel.unprivileged_bpf_disabled = 1
